% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/melsi_robust.R, R/melsi_robust_old.R
\name{melsi}
\alias{melsi}
\title{Run MeLSI Analysis}
\usage{
melsi(
  X,
  y,
  n_perms = 75,
  B = 30,
  m_frac = 0.8,
  show_progress = TRUE,
  plot_vip = TRUE
)

melsi(
  X,
  y,
  n_perms = 75,
  B = 30,
  m_frac = 0.8,
  show_progress = TRUE,
  plot_vip = TRUE
)
}
\arguments{
\item{X}{A matrix of feature abundances with samples as rows and features as columns}

\item{y}{A vector of group labels for each sample}

\item{n_perms}{Number of permutations for p-value calculation (default: 75)}

\item{B}{Number of weak learners in the ensemble (default: 30)}

\item{m_frac}{Fraction of features to use in each weak learner (default: 0.8)}

\item{show_progress}{Whether to display progress information (default: TRUE)}

\item{plot_vip}{Whether to display a Variable Importance Plot (default: TRUE)}

\item{analysis_type}{Type of analysis to perform:
- "auto" (default): Automatically choose based on number of groups
- "pairwise": For 2 groups or all pairwise comparisons for 3+ groups
- "omnibus": Global analysis for 3+ groups (requires at least 3 groups)
- "both": Both omnibus and pairwise for 3+ groups}

\item{correction_method}{Multiple testing correction method for pairwise comparisons (default: "BH")}
}
\value{
For 2 groups or pairwise analysis: List with F-statistic, p-value, feature weights, etc.
        For 3+ groups: List containing omnibus results, pairwise results, or both.

A list containing:
  \item{F_observed}{The observed F-statistic}
  \item{p_value}{The permutation-based p-value}
  \item{feature_weights}{The learned feature weights}
  \item{metric_matrix}{The learned distance metric matrix}
}
\description{
Performs MeLSI (Metric Learning for Statistical Inference) analysis for microbiome data.
Automatically handles both pairwise comparisons (2 groups) and multi-group analysis (3+ groups).

Performs MeLSI (Metric Learning for Statistical Inference) analysis with permutation testing
for microbiome data.
}
